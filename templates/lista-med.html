<!DOCTYPE html>
<html lang="zxx">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Anime | Template</title>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Mulish:wght@300;400;500;600;700;800;900&display=swap"
    rel="stylesheet">

    <!-- Css Styles -->
    <link rel="stylesheet" href="css/bootstrap.min.css" type="text/css">
    <link rel="stylesheet" href="css/font-awesome.min.css" type="text/css">
    <link rel="stylesheet" href="css/elegant-icons.css" type="text/css">
    <link rel="stylesheet" href="css/plyr.css" type="text/css">
    <link rel="stylesheet" href="css/nice-select.css" type="text/css">
    <link rel="stylesheet" href="css/owl.carousel.min.css" type="text/css">
    <link rel="stylesheet" href="css/slicknav.min.css" type="text/css">
    <link rel="stylesheet" href="css/style.css" type="text/css">
    <link rel="stylesheet" href="css/nicepage.css" type="text/css">
    <link rel="stylesheet" href="css/Home.css" type="text/css">
    
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">

</head>

<body>
    <!-- Page Preloder -->
    <div id="preloder">
        <div class="loader"></div>
    </div>

    <!-- Header Section Begin -->
    <script src="js/scripts.js"></script>
    <header class="header">
        <div class="container">
            <div class="row">
                <div class="col-lg-2">
                    <div class="header__logo">
                        <a href="./index.html">
                            <img src="img/logo.png" alt="">
                        </a>
                    </div>
                </div>
                <div class="col-lg-8">
                    <div class="header__nav">
                        <nav class="header__menu mobile-menu">
                            <ul>
                                <li><a href="./index.html">Inicio</a></li>
                                <li><a href="./blog.html">Blog</a></li>
                                <li onclick="check_if_logged()" class="active"> <a a href="#">Mi Perfil</a></li>
                                <li><a href="./index.html">Nosotros</a></li>
                                <li><a href="#">Contactanos</a></li>
                            </ul>
                        </nav>
                    </div>
                </div>
                <div class="col-lg-2">
                    <div class="header__right">     
                        <nav class="header__menu mobile-menu">
                            <ul style="margin-right:-80px;">  
                                <li><a  style="margin-top:-30px; margin-right:-100px;font-size:25px" class="fa fa-user" > <span class="arrow_carrot-down"></span></a>
                                    <ul class="dropdown" style="margin-top:-40px; margin-left: -30px; width: 160px;">
                                        <li onclick="mod_perfil()"><a href="#">Modificar Usuario</a></li>
                                        <li onclick="cerrar_sesion()"><a href="#">Cerrar Sesión</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </nav>
                        
                    </div>
                </div>
            </div>
            <div id="mobile-menu-wrap"></div>
        </div>
    </header>
    <!-- Header End -->

    <!-- Normal Breadcrumb Begin -->
    <section class="normal-breadcrumb set-bg" data-setbg="img/DSC_3930.jpg" style="height: 300px;">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 text-center">
                    <div class="normal__breadcrumb__text">
                        <h2>Lista Doctores</h2>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Normal Breadcrumb End -->

    <!-- Blog Section Begin -->
    <section class="blog spad">
        <div style="margin-right: 90px; margin-left: 90px;">
            <table class="table table-bordered" id="tabla_pacientes">
                <thead class="table-primary">
                  <tr >
                    <th scope="col">No.</th>
                    <th scope="col">Nombre</th>
                    <th scope="col">Descripcion</th>
                    <th scope="col">Precio</th>
                    <th scope="col">Cantidad</th>
                    <th scope="col">Opciones</th>
                  </tr>
                </thead>
                <tbody class="table table-hover" id="detalles"></tbody>
              </table>
              <button onclick="back()" type="button" class="site-btn" style="text-align:center;">Regresar</button>
        </div>
    </section>
    
    <!-- Blog Section End -->

    <!-- Footer Section Begin -->
    <footer class="footer">
        <div class="page-up">
            <a href="#" id="scrollToTopButton"><span class="arrow_carrot-up"></span></a>
        </div>  
        <div class="container">
            <div class="row">
                <div class="col-lg-3">
                    <div class="footer__logo">
                        <a href="./index.html"><img src="img/logo.png" alt=""></a>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="footer__nav">
                        <ul>
                            <li class="active"><a href="./index.html">Homepage</a></li>
                            <li><a href="./categories.html">Categories</a></li>
                            <li><a href="./blog.html">Our Blog</a></li>
                            <li><a href="#">Contacts</a></li>
                        </ul>
                    </div>
                </div>
              </div>
          </div>
      </footer>
      <!-- Footer Section End -->

      <!-- Search model Begin -->
      <div class="search-model">
        <div class="h-100 d-flex align-items-center justify-content-center">
            <div class="search-close-switch"><i class="icon_close"></i></div>
            <form class="search-model-form">
                <input type="text" id="search-input" placeholder="Search here.....">
            </form>
        </div>
    </div>
    <!-- Search model end -->

    <!-- Js Plugins -->
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/player.js"></script>
    <script src="js/jquery.nice-select.min.js"></script>
    <script src="js/mixitup.min.js"></script>
    <script src="js/jquery.slicknav.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/main.js"></script>


    <script>
        function get_data() {
            var tabla = document.querySelector('#detalles');
            var cadena = '';

            fetch('http://127.0.0.1:3000/Med',{
                method: 'GET',
                })
                .then(res => res.json())
                .catch(err =>{
                    console.log("Ha ocurrido un error");
                    alert("Ha ocurrido un error")
                })
                .then(response =>{
                    console.log(response)
                    
                    for(var i in response){
                        cadena += `
                            <tr class="table-light ">
                                <th scope="row">${parseInt(i)+1}</th>
                                <td>${response[i].Nombre}</td>
                                <td>${response[i].Descripcion}</td>
                                <td>${response[i].Precio}</td>
                                <td>${response[i].Cantidad}</td> 
                                <td>
                                    <button type="button" value=${response[i].Nombre} onClick="ver_perfil(this)" class="btn btn-primary"><i class="far fa-eye"></i></button>
                                    <button type="button" value=${response[i].Nombre} onClick="mod_perfil(this)" class="btn btn-success"><i class="fas fa-edit"></i></button>
                                    <button type="button" value=${response[i].Nombre} onClick="del_perfil(this)" class="btn btn-danger"><i class="far fa-trash-alt"></i></button>
                                </td>
                            </tr>
                        `
                    }
                    tabla.innerHTML = cadena;
                })
        }

        function ver_perfil(boton){
            var user = boton.value;
            localStorage.setItem("user", user)
            location.href= "ver-doctor.html"
        }

        function mod_perfil(boton){
            var user = boton.value;
            localStorage.setItem("user", user)
            location.href= "modificar-doctor.html"
        }

        function del_perfil(boton){
            var user = boton.value;
            var r = confirm("Este usuario se borrara permanentemente.  \n¿Desea continuar?");
            if (r == true) {
                
                fetch('http://127.0.0.1:3000/Doctores/' + user + '/borrar',{
                    method: 'POST',
                    })
                    .then(res => res.json())
                    .catch(err =>{
                        console.log("Ha ocurrido un error");
                        alert("Ha ocurrido un error")
                    })
                    .then(response =>{
                        alert(response.Mensaje)
                        location.reload(); 
                    })

            } else {
            
            } 
        }


        window.onload = get_data();
    </script>
    <script>
        function back(){
            location.href= "admin.html"
        }
    </script>

</body>

</html>